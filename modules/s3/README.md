# S3 モジュール

この Terraform モジュールは、静的ウェブサイトのホスティングに設定された Amazon S3 バケットをプロビジョニングし、バージョニングとカスタマイズされたバケットポリシーを含む設定で AWS CloudFront と安全に連携します。このセットアップは HTML、CSS、JavaScript ファイルなどの静的アセットを保存、管理、提供するように設計されています。

## 特徴

- **静的ウェブサイトホスティング**: S3 バケットを静的ウェブコンテンツのホスティング用に設定し、インデックスドキュメントとエラードキュメントを指定します。
- **バケットバージョニング**: オブジェクトのバージョン履歴を保持するためにバージョニングを有効にし、意図しない削除や上書きから回復するのに役立ちます。
- **セキュリティ設定**: 特定の AWS CloudFront 配信からのみオブジェクトへのアクセスを許可する厳格なバケットポリシーを適用し、コンテンツのセキュリティを強化します。

## 使用方法

このモジュールを使用するには、必要な変数（`bucket_name` および `cloudfront_origin_access_identity_arn`）が設定されていることを確認してください。適切なパラメータを使用して Terraform 設定にこのモジュールを含めます：

```hcl
module "s3_bucket" {
  source                            = "path/to/module/s3"
  bucket_name                       = "your-bucket-name"
  cloudfront_origin_access_identity_arn = "your-cloudfront-OAI-ARN"
}
```

## 作成されるリソース

- **aws_s3_bucket.bucket**: プライベートアクセスで設定され、ウェブサイトとして構成された S3 バケット。
- **aws_s3_bucket_versioning.bucket_versioning**: S3 バケットのバージョニング状態を管理し、常に有効にします。
- **aws_s3_bucket_policy.bucket**: バケットにセキュリティポリシーを定義し適用し、関連する CloudFront 配信に基づいてアクセスを制限します。

## パラメータ

- **var.bucket_name**: S3 バケットの名前。
- **var.cloudfront_origin_access_identity_arn**: CloudFront のオリジンアクセスアイデンティティの ARN で、バケットポリシー内で CloudFront が S3 オブジェクトに安全にアクセスするために使用されます。

## セキュリティとパフォーマンスの設定

- **プライベートアクセスレベル**: データが S3 から直接公開的にアクセスされないように、バケットのアクセスレベルをプライベートに設定します。
- **IAM ポリシー統合**: CloudFront との安全な統合のために IAM ポリシーを使用し、許可されたアクションと対象リソースを指定します。

詳細な使用法とさらなるカスタマイズについては、モジュール内の変数定義とリソース設定を参照してください。
